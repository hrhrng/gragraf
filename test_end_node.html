<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>END èŠ‚ç‚¹é”™è¯¯ä¿®å¤æµ‹è¯•</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
            background-color: #1a1a1a;
            color: white;
        }
        .container {
            background-color: #2a2a2a;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        .status {
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            font-weight: bold;
        }
        .success {
            background-color: #4caf50;
            color: white;
        }
        .error {
            background-color: #f44336;
            color: white;
        }
        .info {
            background-color: #2196f3;
            color: white;
        }
        button {
            background-color: #6366f1;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            margin: 10px 5px;
            font-size: 14px;
        }
        button:hover {
            background-color: #5338e5;
        }
        .log {
            background-color: #333;
            padding: 15px;
            border-radius: 6px;
            min-height: 100px;
            font-family: monospace;
            overflow-y: auto;
            max-height: 300px;
            font-size: 12px;
        }
        .error-entry {
            color: #ff6b6b;
            margin-bottom: 5px;
        }
        .info-entry {
            color: #4ecdc4;
            margin-bottom: 5px;
        }
    </style>
</head>
<body>
    <h1>ğŸ”§ END èŠ‚ç‚¹ ResizeObserver é”™è¯¯ä¿®å¤æµ‹è¯•</h1>
    
    <div class="container">
        <h2>æµ‹è¯•çŠ¶æ€</h2>
        <div id="status" class="status info">å‡†å¤‡å¼€å§‹æµ‹è¯•...</div>
        
        <h3>æµ‹è¯•è¯´æ˜</h3>
        <p>æ­¤é¡µé¢ä¸“é—¨æµ‹è¯• END èŠ‚ç‚¹çš„ ResizeObserver é”™è¯¯ä¿®å¤ã€‚å¦‚æœä¿®å¤æˆåŠŸï¼Œæ§åˆ¶å°ä¸­ä¸åº”è¯¥å‡ºç° ResizeObserver ç›¸å…³çš„é”™è¯¯ã€‚</p>
        
        <h3>æµ‹è¯•æ­¥éª¤</h3>
        <ol>
            <li>æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·ï¼ˆF12ï¼‰</li>
            <li>åˆ‡æ¢åˆ° Console æ ‡ç­¾é¡µ</li>
            <li>ç‚¹å‡»ä¸‹é¢çš„"å¼€å§‹æµ‹è¯•"æŒ‰é’®</li>
            <li>è§‚å¯Ÿæ§åˆ¶å°å’Œä¸‹æ–¹çš„é”™è¯¯æ—¥å¿—</li>
            <li>å¦‚æœæ²¡æœ‰ ResizeObserver é”™è¯¯ï¼Œä¿®å¤æˆåŠŸï¼</li>
        </ol>
        
        <button onclick="startTest()">ğŸ§ª å¼€å§‹æµ‹è¯•</button>
        <button onclick="clearLog()">ğŸ§¹ æ¸…é™¤æ—¥å¿—</button>
        <button onclick="openApp()">ğŸš€ æ‰“å¼€ GraGraf åº”ç”¨</button>
    </div>
    
    <div class="container">
        <h2>é”™è¯¯ç›‘æ§æ—¥å¿—</h2>
        <div id="errorLog" class="log">
            <div style="color: #888;">ç­‰å¾…æµ‹è¯•å¼€å§‹...</div>
        </div>
    </div>
    
    <script>
        let errorCount = 0;
        let resizeObserverErrorCount = 0;
        const logElement = document.getElementById('errorLog');
        const statusElement = document.getElementById('status');
        
        // ç›‘æ§æ‰€æœ‰æ§åˆ¶å°é”™è¯¯
        const originalConsoleError = console.error;
        console.error = function(...args) {
            const message = args.join(' ');
            
            if (message.includes('ResizeObserver')) {
                resizeObserverErrorCount++;
                addLogEntry(`âŒ ResizeObserver é”™è¯¯ (#${resizeObserverErrorCount}): ${message}`, 'error');
                updateStatus();
            } else {
                errorCount++;
                addLogEntry(`âš ï¸ å…¶ä»–é”™è¯¯ (#${errorCount}): ${message}`, 'error');
            }
            
            // ä»ç„¶è¾“å‡ºåˆ°åŸå§‹æ§åˆ¶å°
            originalConsoleError.apply(console, args);
        };
        
        // ç›‘æ§å…¨å±€é”™è¯¯äº‹ä»¶
        window.addEventListener('error', function(event) {
            if (event.message && event.message.includes('ResizeObserver')) {
                resizeObserverErrorCount++;
                addLogEntry(`âŒ ResizeObserver å…¨å±€é”™è¯¯: ${event.message}`, 'error');
                updateStatus();
            } else {
                errorCount++;
                addLogEntry(`âš ï¸ å…¨å±€é”™è¯¯: ${event.message}`, 'error');
            }
        });
        
        function addLogEntry(message, type = 'info') {
            const entry = document.createElement('div');
            entry.className = type + '-entry';
            entry.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            logElement.appendChild(entry);
            logElement.scrollTop = logElement.scrollHeight;
        }
        
        function updateStatus() {
            if (resizeObserverErrorCount > 0) {
                statusElement.className = 'status error';
                statusElement.textContent = `âŒ æ£€æµ‹åˆ° ${resizeObserverErrorCount} ä¸ª ResizeObserver é”™è¯¯ - ä¿®å¤æ— æ•ˆ`;
            } else if (errorCount > 0) {
                statusElement.className = 'status info';
                statusElement.textContent = `â„¹ï¸ æ£€æµ‹åˆ° ${errorCount} ä¸ªå…¶ä»–é”™è¯¯ï¼Œä½†æ²¡æœ‰ ResizeObserver é”™è¯¯`;
            } else {
                statusElement.className = 'status success';
                statusElement.textContent = 'âœ… æ²¡æœ‰æ£€æµ‹åˆ°ä»»ä½•é”™è¯¯ - ä¿®å¤æˆåŠŸï¼';
            }
        }
        
        function startTest() {
            addLogEntry('ğŸ§ª å¼€å§‹ ResizeObserver é”™è¯¯æµ‹è¯•...', 'info');
            addLogEntry('ğŸ“ è¿™ä¸ªæµ‹è¯•ä¼šåˆ›å»ºå’Œé”€æ¯ä¸€äº›å…ƒç´ æ¥è§¦å‘å¯èƒ½çš„ ResizeObserver é”™è¯¯', 'info');
            
            // åˆ›å»ºæµ‹è¯•å…ƒç´ 
            for (let i = 0; i < 5; i++) {
                setTimeout(() => {
                    const testDiv = document.createElement('div');
                    testDiv.style.width = '100px';
                    testDiv.style.height = '100px';
                    testDiv.style.backgroundColor = '#444';
                    testDiv.style.margin = '5px';
                    testDiv.style.transition = 'all 0.1s ease';
                    testDiv.style.position = 'absolute';
                    testDiv.style.top = '50px';
                    testDiv.style.left = `${100 + i * 120}px`;
                    
                    document.body.appendChild(testDiv);
                    
                    // å¿«é€Ÿæ”¹å˜å¤§å°
                    setTimeout(() => {
                        testDiv.style.width = '200px';
                        testDiv.style.height = '50px';
                    }, 50);
                    
                    setTimeout(() => {
                        testDiv.style.width = '50px';
                        testDiv.style.height = '200px';
                    }, 100);
                    
                    setTimeout(() => {
                        testDiv.style.width = '150px';
                        testDiv.style.height = '150px';
                    }, 150);
                    
                    // ç§»é™¤å…ƒç´ 
                    setTimeout(() => {
                        document.body.removeChild(testDiv);
                    }, 300);
                }, i * 100);
            }
            
            // æµ‹è¯•å®Œæˆ
            setTimeout(() => {
                addLogEntry('âœ… ResizeObserver æµ‹è¯•å®Œæˆ', 'info');
                updateStatus();
                
                if (resizeObserverErrorCount === 0) {
                    addLogEntry('ğŸ‰ æ­å–œï¼æ²¡æœ‰æ£€æµ‹åˆ° ResizeObserver é”™è¯¯ï¼Œä¿®å¤æˆåŠŸï¼', 'info');
                } else {
                    addLogEntry('ğŸ’” å¾ˆé—æ†¾ï¼Œä»ç„¶æ£€æµ‹åˆ° ResizeObserver é”™è¯¯ï¼Œéœ€è¦è¿›ä¸€æ­¥ä¿®å¤', 'error');
                }
            }, 2000);
        }
        
        function clearLog() {
            logElement.innerHTML = '<div style="color: #888;">æ—¥å¿—å·²æ¸…é™¤...</div>';
            errorCount = 0;
            resizeObserverErrorCount = 0;
            statusElement.className = 'status info';
            statusElement.textContent = 'å‡†å¤‡å¼€å§‹æ–°çš„æµ‹è¯•...';
        }
        
        function openApp() {
            addLogEntry('ğŸš€ æ­£åœ¨æ‰“å¼€ GraGraf åº”ç”¨...', 'info');
            window.open('http://localhost:3000', '_blank');
        }
        
        // åˆå§‹çŠ¶æ€æ›´æ–°
        updateStatus();
    </script>
</body>
</html> 